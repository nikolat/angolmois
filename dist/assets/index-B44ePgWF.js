var xn=Object.defineProperty;var vn=(e,t,n)=>t in e?xn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var H=(e,t,n)=>vn(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function Ct(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function jt(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Bn(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ct(e.outputLen),Ct(e.blockLen)}function je(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Sn(e,t){jt(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const et=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Vt=e=>e instanceof Uint8Array,tt=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),ue=(e,t)=>e<<32-t|e>>>t,An=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!An)throw new Error("Non little-endian hardware is not supported");function In(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function mt(e){if(typeof e=="string"&&(e=In(e)),!Vt(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function Tn(...e){const t=new Uint8Array(e.reduce((r,o)=>r+o.length,0));let n=0;return e.forEach(r=>{if(!Vt(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}let Kt=class{clone(){return this._cloneInto()}};function kn(e){const t=r=>e().update(mt(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Wt(e=32){if(et&&typeof et.getRandomValues=="function")return et.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function Cn(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,u=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+u,c,r)}let Nn=class extends Kt{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=tt(this.buffer)}update(t){je(this);const{view:n,buffer:r,blockLen:o}=this;t=mt(t);const s=t.length;for(let i=0;i<s;){const c=Math.min(o-this.pos,s-i);if(c===o){const a=tt(t);for(;o<=s-i;i+=o)this.process(a,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){je(this),Sn(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:s}=this;let{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let l=i;l<o;l++)n[l]=0;Cn(r,o-8,BigInt(this.length*8),s),this.process(r,0);const c=tt(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=a/4,h=this.get();if(u>h.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)c.setUint32(4*l,h[l],s)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%n&&t.buffer.set(r),t}};const Ln=(e,t,n)=>e&t^~e&n,$n=(e,t,n)=>e&t^e&n^t&n,On=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),be=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),me=new Uint32Array(64);let Hn=class extends Nn{constructor(){super(64,32,8,!1),this.A=be[0]|0,this.B=be[1]|0,this.C=be[2]|0,this.D=be[3]|0,this.E=be[4]|0,this.F=be[5]|0,this.G=be[6]|0,this.H=be[7]|0}get(){const{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:a}=this;return[t,n,r,o,s,i,c,a]}set(t,n,r,o,s,i,c,a){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=a|0}process(t,n){for(let l=0;l<16;l++,n+=4)me[l]=t.getUint32(n,!1);for(let l=16;l<64;l++){const f=me[l-15],g=me[l-2],S=ue(f,7)^ue(f,18)^f>>>3,p=ue(g,17)^ue(g,19)^g>>>10;me[l]=p+me[l-7]+S+me[l-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:a,G:u,H:h}=this;for(let l=0;l<64;l++){const f=ue(c,6)^ue(c,11)^ue(c,25),g=h+f+Ln(c,a,u)+On[l]+me[l]|0,p=(ue(r,2)^ue(r,13)^ue(r,22))+$n(r,o,s)|0;h=u,u=a,a=c,c=i+g|0,i=s,s=o,o=r,r=g+p|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,a=a+this.F|0,u=u+this.G|0,h=h+this.H|0,this.set(r,o,s,i,c,a,u,h)}roundClean(){me.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const lt=kn(()=>new Hn);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zt=BigInt(0),De=BigInt(1),Un=BigInt(2),Fe=e=>e instanceof Uint8Array,Rn=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Ne(e){if(!Fe(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=Rn[e[n]];return t}function Gt(e){const t=e.toString(16);return t.length&1?`0${t}`:t}function Et(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function Le(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){const o=r*2,s=e.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n}function re(e){return Et(Ne(e))}function xt(e){if(!Fe(e))throw new Error("Uint8Array expected");return Et(Ne(Uint8Array.from(e).reverse()))}function ve(e,t){return Le(e.toString(16).padStart(t*2,"0"))}function vt(e,t){return ve(e,t).reverse()}function _n(e){return Le(Gt(e))}function X(e,t,n){let r;if(typeof t=="string")try{r=Le(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(Fe(t))r=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);const o=r.length;if(typeof n=="number"&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function ke(...e){const t=new Uint8Array(e.reduce((r,o)=>r+o.length,0));let n=0;return e.forEach(r=>{if(!Fe(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}function Pn(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function qn(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Mn(e){let t;for(t=0;e>zt;e>>=De,t+=1);return t}function jn(e,t){return e>>BigInt(t)&De}const Vn=(e,t,n)=>e|(n?De:zt)<<BigInt(t),Bt=e=>(Un<<BigInt(e-1))-De,nt=e=>new Uint8Array(e),Nt=e=>Uint8Array.from(e);function Dt(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=nt(e),o=nt(e),s=0;const i=()=>{r.fill(1),o.fill(0),s=0},c=(...l)=>n(o,r,...l),a=(l=nt())=>{o=c(Nt([0]),l),r=c(),l.length!==0&&(o=c(Nt([1]),l),r=c())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const f=[];for(;l<t;){r=c();const g=r.slice();f.push(g),l+=r.length}return ke(...f)};return(l,f)=>{i(),a(l);let g;for(;!(g=f(u()));)a();return i(),g}}const Kn={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function qe(e,t,n={}){const r=(o,s,i)=>{const c=Kn[s];if(typeof c!="function")throw new Error(`Invalid validator "${s}", expected function`);const a=e[o];if(!(i&&a===void 0)&&!c(a,e))throw new Error(`Invalid param ${String(o)}=${a} (${typeof a}), expected ${s}`)};for(const[o,s]of Object.entries(t))r(o,s,!1);for(const[o,s]of Object.entries(n))r(o,s,!0);return e}const Wn=Object.freeze(Object.defineProperty({__proto__:null,bitGet:jn,bitLen:Mn,bitMask:Bt,bitSet:Vn,bytesToHex:Ne,bytesToNumberBE:re,bytesToNumberLE:xt,concatBytes:ke,createHmacDrbg:Dt,ensureBytes:X,equalBytes:Pn,hexToBytes:Le,hexToNumber:Et,numberToBytesBE:ve,numberToBytesLE:vt,numberToHexUnpadded:Gt,numberToVarBytesBE:_n,utf8ToBytes:qn,validateObject:qe},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Y=BigInt(0),G=BigInt(1),Ie=BigInt(2),zn=BigInt(3),ut=BigInt(4),Lt=BigInt(5),$t=BigInt(8);BigInt(9);BigInt(16);function J(e,t){const n=e%t;return n>=Y?n:t+n}function Gn(e,t,n){if(n<=Y||t<Y)throw new Error("Expected power/modulo > 0");if(n===G)return Y;let r=G;for(;t>Y;)t&G&&(r=r*e%n),e=e*e%n,t>>=G;return r}function ie(e,t,n){let r=e;for(;t-- >Y;)r*=r,r%=n;return r}function dt(e,t){if(e===Y||t<=Y)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=J(e,t),r=t,o=Y,s=G;for(;n!==Y;){const c=r/n,a=r%n,u=o-s*c;r=n,n=a,o=s,s=u}if(r!==G)throw new Error("invert: does not exist");return J(o,t)}function Dn(e){const t=(e-G)/Ie;let n,r,o;for(n=e-G,r=0;n%Ie===Y;n/=Ie,r++);for(o=Ie;o<e&&Gn(o,t,e)!==e-G;o++);if(r===1){const i=(e+G)/ut;return function(a,u){const h=a.pow(u,i);if(!a.eql(a.sqr(h),u))throw new Error("Cannot find square root");return h}}const s=(n+G)/Ie;return function(c,a){if(c.pow(a,t)===c.neg(c.ONE))throw new Error("Cannot find square root");let u=r,h=c.pow(c.mul(c.ONE,o),n),l=c.pow(a,s),f=c.pow(a,n);for(;!c.eql(f,c.ONE);){if(c.eql(f,c.ZERO))return c.ZERO;let g=1;for(let p=c.sqr(f);g<u&&!c.eql(p,c.ONE);g++)p=c.sqr(p);const S=c.pow(h,G<<BigInt(u-g-1));h=c.sqr(S),l=c.mul(l,S),f=c.mul(f,h),u=g}return l}}function Fn(e){if(e%ut===zn){const t=(e+G)/ut;return function(r,o){const s=r.pow(o,t);if(!r.eql(r.sqr(s),o))throw new Error("Cannot find square root");return s}}if(e%$t===Lt){const t=(e-Lt)/$t;return function(r,o){const s=r.mul(o,Ie),i=r.pow(s,t),c=r.mul(o,i),a=r.mul(r.mul(c,Ie),i),u=r.mul(c,r.sub(a,r.ONE));if(!r.eql(r.sqr(u),o))throw new Error("Cannot find square root");return u}}return Dn(e)}const Zn=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Yn(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Zn.reduce((r,o)=>(r[o]="function",r),t);return qe(e,n)}function Jn(e,t,n){if(n<Y)throw new Error("Expected power > 0");if(n===Y)return e.ONE;if(n===G)return t;let r=e.ONE,o=t;for(;n>Y;)n&G&&(r=e.mul(r,o)),o=e.sqr(o),n>>=G;return r}function Qn(e,t){const n=new Array(t.length),r=t.reduce((s,i,c)=>e.is0(i)?s:(n[c]=s,e.mul(s,i)),e.ONE),o=e.inv(r);return t.reduceRight((s,i,c)=>e.is0(i)?s:(n[c]=e.mul(s,n[c]),e.mul(s,i)),o),n}function Ft(e,t){const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Xn(e,t,n=!1,r={}){if(e<=Y)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:o,nByteLength:s}=Ft(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const i=Fn(e),c=Object.freeze({ORDER:e,BITS:o,BYTES:s,MASK:Bt(o),ZERO:Y,ONE:G,create:a=>J(a,e),isValid:a=>{if(typeof a!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof a}`);return Y<=a&&a<e},is0:a=>a===Y,isOdd:a=>(a&G)===G,neg:a=>J(-a,e),eql:(a,u)=>a===u,sqr:a=>J(a*a,e),add:(a,u)=>J(a+u,e),sub:(a,u)=>J(a-u,e),mul:(a,u)=>J(a*u,e),pow:(a,u)=>Jn(c,a,u),div:(a,u)=>J(a*dt(u,e),e),sqrN:a=>a*a,addN:(a,u)=>a+u,subN:(a,u)=>a-u,mulN:(a,u)=>a*u,inv:a=>dt(a,e),sqrt:r.sqrt||(a=>i(c,a)),invertBatch:a=>Qn(c,a),cmov:(a,u,h)=>h?u:a,toBytes:a=>n?vt(a,s):ve(a,s),fromBytes:a=>{if(a.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${a.length}`);return n?xt(a):re(a)}});return Object.freeze(c)}function Zt(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Yt(e){const t=Zt(e);return t+Math.ceil(t/2)}function er(e,t,n=!1){const r=e.length,o=Zt(t),s=Yt(t);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);const i=n?re(e):xt(e),c=J(i,t-G)+G;return n?vt(c,o):ve(c,o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const tr=BigInt(0),rt=BigInt(1);function nr(e,t){const n=(o,s)=>{const i=s.negate();return o?i:s},r=o=>{const s=Math.ceil(t/o)+1,i=2**(o-1);return{windows:s,windowSize:i}};return{constTimeNegate:n,unsafeLadder(o,s){let i=e.ZERO,c=o;for(;s>tr;)s&rt&&(i=i.add(c)),c=c.double(),s>>=rt;return i},precomputeWindow(o,s){const{windows:i,windowSize:c}=r(s),a=[];let u=o,h=u;for(let l=0;l<i;l++){h=u,a.push(h);for(let f=1;f<c;f++)h=h.add(u),a.push(h);u=h.double()}return a},wNAF(o,s,i){const{windows:c,windowSize:a}=r(o);let u=e.ZERO,h=e.BASE;const l=BigInt(2**o-1),f=2**o,g=BigInt(o);for(let S=0;S<c;S++){const p=S*a;let w=Number(i&l);i>>=g,w>a&&(w-=f,i+=rt);const x=p,B=p+Math.abs(w)-1,L=S%2!==0,q=w<0;w===0?h=h.add(n(L,s[x])):u=u.add(n(q,s[B]))}return{p:u,f:h}},wNAFCached(o,s,i,c){const a=o._WINDOW_SIZE||1;let u=s.get(o);return u||(u=this.precomputeWindow(o,a),a!==1&&s.set(o,c(u))),this.wNAF(a,u,i)}}}function Jt(e){return Yn(e.Fp),qe(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Ft(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function rr(e){const t=Jt(e);qe(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:or,hexToBytes:sr}=Wn,Te={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){const{Err:t}=Te;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");const n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(r[0]&128)throw new t("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:or(r),l:e.subarray(n+2)}},toSig(e){const{Err:t}=Te,n=typeof e=="string"?sr(e):e;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:o,l:s}=Te._parseInt(n.subarray(2)),{d:i,l:c}=Te._parseInt(s);if(c.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:i}},hexFromSig(e){const t=u=>Number.parseInt(u[0],16)&8?"00"+u:u,n=u=>{const h=u.toString(16);return h.length&1?`0${h}`:h},r=t(n(e.s)),o=t(n(e.r)),s=r.length/2,i=o.length/2,c=n(s),a=n(i);return`30${n(i+s+4)}02${a}${o}02${c}${r}`}},he=BigInt(0),ce=BigInt(1);BigInt(2);const Ot=BigInt(3);BigInt(4);function ir(e){const t=rr(e),{Fp:n}=t,r=t.toBytes||((S,p,w)=>{const x=p.toAffine();return ke(Uint8Array.from([4]),n.toBytes(x.x),n.toBytes(x.y))}),o=t.fromBytes||(S=>{const p=S.subarray(1),w=n.fromBytes(p.subarray(0,n.BYTES)),x=n.fromBytes(p.subarray(n.BYTES,2*n.BYTES));return{x:w,y:x}});function s(S){const{a:p,b:w}=t,x=n.sqr(S),B=n.mul(x,S);return n.add(n.add(B,n.mul(S,p)),w)}if(!n.eql(n.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function i(S){return typeof S=="bigint"&&he<S&&S<t.n}function c(S){if(!i(S))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function a(S){const{allowedPrivateKeyLengths:p,nByteLength:w,wrapPrivateKey:x,n:B}=t;if(p&&typeof S!="bigint"){if(S instanceof Uint8Array&&(S=Ne(S)),typeof S!="string"||!p.includes(S.length))throw new Error("Invalid key");S=S.padStart(w*2,"0")}let L;try{L=typeof S=="bigint"?S:re(X("private key",S,w))}catch{throw new Error(`private key must be ${w} bytes, hex or bigint, not ${typeof S}`)}return x&&(L=J(L,B)),c(L),L}const u=new Map;function h(S){if(!(S instanceof l))throw new Error("ProjectivePoint expected")}class l{constructor(p,w,x){if(this.px=p,this.py=w,this.pz=x,p==null||!n.isValid(p))throw new Error("x required");if(w==null||!n.isValid(w))throw new Error("y required");if(x==null||!n.isValid(x))throw new Error("z required")}static fromAffine(p){const{x:w,y:x}=p||{};if(!p||!n.isValid(w)||!n.isValid(x))throw new Error("invalid affine point");if(p instanceof l)throw new Error("projective point not allowed");const B=L=>n.eql(L,n.ZERO);return B(w)&&B(x)?l.ZERO:new l(w,x,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){const w=n.invertBatch(p.map(x=>x.pz));return p.map((x,B)=>x.toAffine(w[B])).map(l.fromAffine)}static fromHex(p){const w=l.fromAffine(o(X("pointHex",p)));return w.assertValidity(),w}static fromPrivateKey(p){return l.BASE.multiply(a(p))}_setWindowSize(p){this._WINDOW_SIZE=p,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:p,y:w}=this.toAffine();if(!n.isValid(p)||!n.isValid(w))throw new Error("bad point: x or y not FE");const x=n.sqr(w),B=s(p);if(!n.eql(x,B))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:p}=this.toAffine();if(n.isOdd)return!n.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){h(p);const{px:w,py:x,pz:B}=this,{px:L,py:q,pz:P}=p,N=n.eql(n.mul(w,P),n.mul(L,B)),$=n.eql(n.mul(x,P),n.mul(q,B));return N&&$}negate(){return new l(this.px,n.neg(this.py),this.pz)}double(){const{a:p,b:w}=t,x=n.mul(w,Ot),{px:B,py:L,pz:q}=this;let P=n.ZERO,N=n.ZERO,$=n.ZERO,R=n.mul(B,B),ne=n.mul(L,L),I=n.mul(q,q),A=n.mul(B,L);return A=n.add(A,A),$=n.mul(B,q),$=n.add($,$),P=n.mul(p,$),N=n.mul(x,I),N=n.add(P,N),P=n.sub(ne,N),N=n.add(ne,N),N=n.mul(P,N),P=n.mul(A,P),$=n.mul(x,$),I=n.mul(p,I),A=n.sub(R,I),A=n.mul(p,A),A=n.add(A,$),$=n.add(R,R),R=n.add($,R),R=n.add(R,I),R=n.mul(R,A),N=n.add(N,R),I=n.mul(L,q),I=n.add(I,I),R=n.mul(I,A),P=n.sub(P,R),$=n.mul(I,ne),$=n.add($,$),$=n.add($,$),new l(P,N,$)}add(p){h(p);const{px:w,py:x,pz:B}=this,{px:L,py:q,pz:P}=p;let N=n.ZERO,$=n.ZERO,R=n.ZERO;const ne=t.a,I=n.mul(t.b,Ot);let A=n.mul(w,L),k=n.mul(x,q),M=n.mul(B,P),U=n.add(w,x),d=n.add(L,q);U=n.mul(U,d),d=n.add(A,k),U=n.sub(U,d),d=n.add(w,B);let y=n.add(L,P);return d=n.mul(d,y),y=n.add(A,M),d=n.sub(d,y),y=n.add(x,B),N=n.add(q,P),y=n.mul(y,N),N=n.add(k,M),y=n.sub(y,N),R=n.mul(ne,d),N=n.mul(I,M),R=n.add(N,R),N=n.sub(k,R),R=n.add(k,R),$=n.mul(N,R),k=n.add(A,A),k=n.add(k,A),M=n.mul(ne,M),d=n.mul(I,d),k=n.add(k,M),M=n.sub(A,M),M=n.mul(ne,M),d=n.add(d,M),A=n.mul(k,d),$=n.add($,A),A=n.mul(y,d),N=n.mul(U,N),N=n.sub(N,A),A=n.mul(U,k),R=n.mul(y,R),R=n.add(R,A),new l(N,$,R)}subtract(p){return this.add(p.negate())}is0(){return this.equals(l.ZERO)}wNAF(p){return g.wNAFCached(this,u,p,w=>{const x=n.invertBatch(w.map(B=>B.pz));return w.map((B,L)=>B.toAffine(x[L])).map(l.fromAffine)})}multiplyUnsafe(p){const w=l.ZERO;if(p===he)return w;if(c(p),p===ce)return this;const{endo:x}=t;if(!x)return g.unsafeLadder(this,p);let{k1neg:B,k1:L,k2neg:q,k2:P}=x.splitScalar(p),N=w,$=w,R=this;for(;L>he||P>he;)L&ce&&(N=N.add(R)),P&ce&&($=$.add(R)),R=R.double(),L>>=ce,P>>=ce;return B&&(N=N.negate()),q&&($=$.negate()),$=new l(n.mul($.px,x.beta),$.py,$.pz),N.add($)}multiply(p){c(p);let w=p,x,B;const{endo:L}=t;if(L){const{k1neg:q,k1:P,k2neg:N,k2:$}=L.splitScalar(w);let{p:R,f:ne}=this.wNAF(P),{p:I,f:A}=this.wNAF($);R=g.constTimeNegate(q,R),I=g.constTimeNegate(N,I),I=new l(n.mul(I.px,L.beta),I.py,I.pz),x=R.add(I),B=ne.add(A)}else{const{p:q,f:P}=this.wNAF(w);x=q,B=P}return l.normalizeZ([x,B])[0]}multiplyAndAddUnsafe(p,w,x){const B=l.BASE,L=(P,N)=>N===he||N===ce||!P.equals(B)?P.multiplyUnsafe(N):P.multiply(N),q=L(this,w).add(L(p,x));return q.is0()?void 0:q}toAffine(p){const{px:w,py:x,pz:B}=this,L=this.is0();p==null&&(p=L?n.ONE:n.inv(B));const q=n.mul(w,p),P=n.mul(x,p),N=n.mul(B,p);if(L)return{x:n.ZERO,y:n.ZERO};if(!n.eql(N,n.ONE))throw new Error("invZ was invalid");return{x:q,y:P}}isTorsionFree(){const{h:p,isTorsionFree:w}=t;if(p===ce)return!0;if(w)return w(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:p,clearCofactor:w}=t;return p===ce?this:w?w(l,this):this.multiplyUnsafe(t.h)}toRawBytes(p=!0){return this.assertValidity(),r(l,this,p)}toHex(p=!0){return Ne(this.toRawBytes(p))}}l.BASE=new l(t.Gx,t.Gy,n.ONE),l.ZERO=new l(n.ZERO,n.ONE,n.ZERO);const f=t.nBitLength,g=nr(l,t.endo?Math.ceil(f/2):f);return{CURVE:t,ProjectivePoint:l,normPrivateKeyToScalar:a,weierstrassEquation:s,isWithinCurveOrder:i}}function cr(e){const t=Jt(e);return qe(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function ar(e){const t=cr(e),{Fp:n,n:r}=t,o=n.BYTES+1,s=2*n.BYTES+1;function i(d){return he<d&&d<n.ORDER}function c(d){return J(d,r)}function a(d){return dt(d,r)}const{ProjectivePoint:u,normPrivateKeyToScalar:h,weierstrassEquation:l,isWithinCurveOrder:f}=ir({...t,toBytes(d,y,b){const C=y.toAffine(),E=n.toBytes(C.x),v=ke;return b?v(Uint8Array.from([y.hasEvenY()?2:3]),E):v(Uint8Array.from([4]),E,n.toBytes(C.y))},fromBytes(d){const y=d.length,b=d[0],C=d.subarray(1);if(y===o&&(b===2||b===3)){const E=re(C);if(!i(E))throw new Error("Point is not on curve");const v=l(E);let m=n.sqrt(v);const T=(m&ce)===ce;return(b&1)===1!==T&&(m=n.neg(m)),{x:E,y:m}}else if(y===s&&b===4){const E=n.fromBytes(C.subarray(0,n.BYTES)),v=n.fromBytes(C.subarray(n.BYTES,2*n.BYTES));return{x:E,y:v}}else throw new Error(`Point of length ${y} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}}),g=d=>Ne(ve(d,t.nByteLength));function S(d){const y=r>>ce;return d>y}function p(d){return S(d)?c(-d):d}const w=(d,y,b)=>re(d.slice(y,b));class x{constructor(y,b,C){this.r=y,this.s=b,this.recovery=C,this.assertValidity()}static fromCompact(y){const b=t.nByteLength;return y=X("compactSignature",y,b*2),new x(w(y,0,b),w(y,b,2*b))}static fromDER(y){const{r:b,s:C}=Te.toSig(X("DER",y));return new x(b,C)}assertValidity(){if(!f(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!f(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(y){return new x(this.r,this.s,y)}recoverPublicKey(y){const{r:b,s:C,recovery:E}=this,v=$(X("msgHash",y));if(E==null||![0,1,2,3].includes(E))throw new Error("recovery id invalid");const m=E===2||E===3?b+t.n:b;if(m>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const T=E&1?"03":"02",_=u.fromHex(T+g(m)),j=a(m),V=c(-v*j),K=c(C*j),z=u.BASE.multiplyAndAddUnsafe(_,V,K);if(!z)throw new Error("point at infinify");return z.assertValidity(),z}hasHighS(){return S(this.s)}normalizeS(){return this.hasHighS()?new x(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Le(this.toDERHex())}toDERHex(){return Te.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Le(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}const B={isValidPrivateKey(d){try{return h(d),!0}catch{return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>{const d=Yt(t.n);return er(t.randomBytes(d),t.n)},precompute(d=8,y=u.BASE){return y._setWindowSize(d),y.multiply(BigInt(3)),y}};function L(d,y=!0){return u.fromPrivateKey(d).toRawBytes(y)}function q(d){const y=d instanceof Uint8Array,b=typeof d=="string",C=(y||b)&&d.length;return y?C===o||C===s:b?C===2*o||C===2*s:d instanceof u}function P(d,y,b=!0){if(q(d))throw new Error("first arg must be private key");if(!q(y))throw new Error("second arg must be public key");return u.fromHex(y).multiply(h(d)).toRawBytes(b)}const N=t.bits2int||function(d){const y=re(d),b=d.length*8-t.nBitLength;return b>0?y>>BigInt(b):y},$=t.bits2int_modN||function(d){return c(N(d))},R=Bt(t.nBitLength);function ne(d){if(typeof d!="bigint")throw new Error("bigint expected");if(!(he<=d&&d<R))throw new Error(`bigint expected < 2^${t.nBitLength}`);return ve(d,t.nByteLength)}function I(d,y,b=A){if(["recovered","canonical"].some(Q=>Q in b))throw new Error("sign() legacy options not supported");const{hash:C,randomBytes:E}=t;let{lowS:v,prehash:m,extraEntropy:T}=b;v==null&&(v=!0),d=X("msgHash",d),m&&(d=X("prehashed msgHash",C(d)));const _=$(d),j=h(y),V=[ne(j),ne(_)];if(T!=null){const Q=T===!0?E(n.BYTES):T;V.push(X("extraEntropy",Q))}const K=ke(...V),z=_;function ee(Q){const F=N(Q);if(!f(F))return;const ae=a(F),W=u.BASE.multiply(F).toAffine(),Z=c(W.x);if(Z===he)return;const se=c(ae*c(z+Z*j));if(se===he)return;let we=(W.x===Z?0:2)|Number(W.y&ce),O=se;return v&&S(se)&&(O=p(se),we^=1),new x(Z,O,we)}return{seed:K,k2sig:ee}}const A={lowS:t.lowS,prehash:!1},k={lowS:t.lowS,prehash:!1};function M(d,y,b=A){const{seed:C,k2sig:E}=I(d,y,b),v=t;return Dt(v.hash.outputLen,v.nByteLength,v.hmac)(C,E)}u.BASE._setWindowSize(8);function U(d,y,b,C=k){var W;const E=d;if(y=X("msgHash",y),b=X("publicKey",b),"strict"in C)throw new Error("options.strict was renamed to lowS");const{lowS:v,prehash:m}=C;let T,_;try{if(typeof E=="string"||E instanceof Uint8Array)try{T=x.fromDER(E)}catch(Z){if(!(Z instanceof Te.Err))throw Z;T=x.fromCompact(E)}else if(typeof E=="object"&&typeof E.r=="bigint"&&typeof E.s=="bigint"){const{r:Z,s:se}=E;T=new x(Z,se)}else throw new Error("PARSE");_=u.fromHex(b)}catch(Z){if(Z.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(v&&T.hasHighS())return!1;m&&(y=t.hash(y));const{r:j,s:V}=T,K=$(y),z=a(V),ee=c(K*z),Q=c(j*z),F=(W=u.BASE.multiplyAndAddUnsafe(_,ee,Q))==null?void 0:W.toAffine();return F?c(F.x)===j:!1}return{CURVE:t,getPublicKey:L,getSharedSecret:P,sign:M,verify:U,ProjectivePoint:u,Signature:x,utils:B}}class Qt extends Kt{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,Bn(t);const r=mt(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?t.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(t){return je(this),this.iHash.update(t),this}digestInto(t){je(this),jt(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Xt=(e,t,n)=>new Qt(e,t).update(n).digest();Xt.create=(e,t)=>new Qt(e,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function lr(e){return{hash:e,hmac:(t,...n)=>Xt(e,t,Tn(...n)),randomBytes:Wt}}function ur(e,t){const n=r=>ar({...e,...lr(r)});return Object.freeze({...n(t),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ze=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ve=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),en=BigInt(1),Ke=BigInt(2),Ht=(e,t)=>(e+t/Ke)/t;function tn(e){const t=Ze,n=BigInt(3),r=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),c=BigInt(44),a=BigInt(88),u=e*e*e%t,h=u*u*e%t,l=ie(h,n,t)*h%t,f=ie(l,n,t)*h%t,g=ie(f,Ke,t)*u%t,S=ie(g,o,t)*g%t,p=ie(S,s,t)*S%t,w=ie(p,c,t)*p%t,x=ie(w,a,t)*w%t,B=ie(x,c,t)*p%t,L=ie(B,n,t)*h%t,q=ie(L,i,t)*S%t,P=ie(q,r,t)*u%t,N=ie(P,Ke,t);if(!ft.eql(ft.sqr(N),e))throw new Error("Cannot find square root");return N}const ft=Xn(Ze,void 0,void 0,{sqrt:tn}),St=ur({a:BigInt(0),b:BigInt(7),Fp:ft,n:Ve,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=Ve,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-en*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,i=BigInt("0x100000000000000000000000000000000"),c=Ht(s*e,t),a=Ht(-r*e,t);let u=J(e-c*n-a*o,t),h=J(-c*r-a*s,t);const l=u>i,f=h>i;if(l&&(u=t-u),f&&(h=t-h),u>i||h>i)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:l,k1:u,k2neg:f,k2:h}}}},lt),Ye=BigInt(0),nn=e=>typeof e=="bigint"&&Ye<e&&e<Ze,dr=e=>typeof e=="bigint"&&Ye<e&&e<Ve,Ut={};function We(e,...t){let n=Ut[e];if(n===void 0){const r=lt(Uint8Array.from(e,o=>o.charCodeAt(0)));n=ke(r,r),Ut[e]=n}return lt(ke(n,...t))}const At=e=>e.toRawBytes(!0).slice(1),ht=e=>ve(e,32),ot=e=>J(e,Ze),Pe=e=>J(e,Ve),It=St.ProjectivePoint,fr=(e,t,n)=>It.BASE.multiplyAndAddUnsafe(e,t,n);function pt(e){let t=St.utils.normPrivateKeyToScalar(e),n=It.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:Pe(-t),bytes:At(n)}}function rn(e){if(!nn(e))throw new Error("bad x: need 0 < x < p");const t=ot(e*e),n=ot(t*e+BigInt(7));let r=tn(n);r%Ke!==Ye&&(r=ot(-r));const o=new It(e,r,en);return o.assertValidity(),o}function on(...e){return Pe(re(We("BIP0340/challenge",...e)))}function hr(e){return pt(e).bytes}function pr(e,t,n=Wt(32)){const r=X("message",e),{bytes:o,scalar:s}=pt(t),i=X("auxRand",n,32),c=ht(s^re(We("BIP0340/aux",i))),a=We("BIP0340/nonce",c,o,r),u=Pe(re(a));if(u===Ye)throw new Error("sign failed: k is zero");const{bytes:h,scalar:l}=pt(u),f=on(h,o,r),g=new Uint8Array(64);if(g.set(h,0),g.set(ht(Pe(l+f*s)),32),!sn(g,r,o))throw new Error("sign: Invalid signature produced");return g}function sn(e,t,n){const r=X("signature",e,64),o=X("message",t),s=X("publicKey",n,32);try{const i=rn(re(s)),c=re(r.subarray(0,32));if(!nn(c))return!1;const a=re(r.subarray(32,64));if(!dr(a))return!1;const u=on(ht(c),At(i),o),h=fr(i,a,Pe(-u));return!(!h||!h.hasEvenY()||h.toAffine().x!==c)}catch{return!1}}const fe={getPublicKey:hr,sign:pr,verify:sn,utils:{randomPrivateKey:St.utils.randomPrivateKey,lift_x:rn,pointToBytes:At,numberToBytesBE:ve,bytesToNumberBE:re,taggedHash:We,mod:J}};/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const cn=e=>e instanceof Uint8Array,st=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),de=(e,t)=>e<<32-t|e>>>t,yr=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!yr)throw new Error("Non little-endian hardware is not supported");const gr=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function te(e){if(!cn(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=gr[e[n]];return t}function an(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){const o=r*2,s=e.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n}function wr(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function ln(e){if(typeof e=="string"&&(e=wr(e)),!cn(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}class br{clone(){return this._cloneInto()}}function un(e){const t=r=>e().update(ln(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function yt(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function mr(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function dn(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Er(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");yt(e.outputLen),yt(e.blockLen)}function xr(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function vr(e,t){dn(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const it={number:yt,bool:mr,bytes:dn,hash:Er,exists:xr,output:vr};function Br(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,u=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+u,c,r)}class Sr extends br{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=st(this.buffer)}update(t){it.exists(this);const{view:n,buffer:r,blockLen:o}=this;t=ln(t);const s=t.length;for(let i=0;i<s;){const c=Math.min(o-this.pos,s-i);if(c===o){const a=st(t);for(;o<=s-i;i+=o)this.process(a,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){it.exists(this),it.output(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:s}=this;let{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let l=i;l<o;l++)n[l]=0;Br(r,o-8,BigInt(this.length*8),s),this.process(r,0);const c=st(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=a/4,h=this.get();if(u>h.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)c.setUint32(4*l,h[l],s)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%n&&t.buffer.set(r),t}}const Ar=(e,t,n)=>e&t^~e&n,Ir=(e,t,n)=>e&t^e&n^t&n,Tr=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ee=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),xe=new Uint32Array(64);class fn extends Sr{constructor(){super(64,32,8,!1),this.A=Ee[0]|0,this.B=Ee[1]|0,this.C=Ee[2]|0,this.D=Ee[3]|0,this.E=Ee[4]|0,this.F=Ee[5]|0,this.G=Ee[6]|0,this.H=Ee[7]|0}get(){const{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:a}=this;return[t,n,r,o,s,i,c,a]}set(t,n,r,o,s,i,c,a){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=a|0}process(t,n){for(let l=0;l<16;l++,n+=4)xe[l]=t.getUint32(n,!1);for(let l=16;l<64;l++){const f=xe[l-15],g=xe[l-2],S=de(f,7)^de(f,18)^f>>>3,p=de(g,17)^de(g,19)^g>>>10;xe[l]=p+xe[l-7]+S+xe[l-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:a,G:u,H:h}=this;for(let l=0;l<64;l++){const f=de(c,6)^de(c,11)^de(c,25),g=h+f+Ar(c,a,u)+Tr[l]+xe[l]|0,p=(de(r,2)^de(r,13)^de(r,22))+Ir(r,o,s)|0;h=u,u=a,a=c,c=i+g|0,i=s,s=o,o=r,r=g+p|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,a=a+this.F|0,u=u+this.G|0,h=h+this.H|0,this.set(r,o,s,i,c,a,u,h)}roundClean(){xe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class kr extends fn{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const hn=un(()=>new fn);un(()=>new kr);var Ae=Symbol("verified"),Cr=e=>e instanceof Object;function Nr(e){if(!Cr(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]=="object")return!1}return!0}new TextDecoder("utf-8");var Lr=new TextEncoder;function _e(e){e.indexOf("://")===-1&&(e="wss://"+e);let t=new URL(e);return t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),(t.port==="80"&&t.protocol==="ws:"||t.port==="443"&&t.protocol==="wss:")&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}var $r=class{constructor(e){H(this,"value");H(this,"next",null);H(this,"prev",null);this.value=e}},Or=class{constructor(){H(this,"first");H(this,"last");this.first=null,this.last=null}enqueue(e){const t=new $r(e);return this.last?this.last===this.first?(this.last=t,this.last.prev=this.first,this.first.next=t):(t.prev=this.last,this.last.next=t,this.last=t):(this.first=t,this.last=t),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const t=this.first;return this.first=null,this.last=null,t.value}const e=this.first;return this.first=e.next,e.value}},Hr=class{generateSecretKey(){return fe.utils.randomPrivateKey()}getPublicKey(t){return te(fe.getPublicKey(t))}finalizeEvent(t,n){const r=t;return r.pubkey=te(fe.getPublicKey(n)),r.id=ct(r),r.sig=te(fe.sign(ct(r),n)),r[Ae]=!0,r}verifyEvent(t){if(typeof t[Ae]=="boolean")return t[Ae];const n=ct(t);if(n!==t.id)return t[Ae]=!1,!1;try{const r=fe.verify(t.sig,n,t.pubkey);return t[Ae]=r,r}catch{return t[Ae]=!1,!1}}};function Ur(e){if(!Nr(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function ct(e){let t=hn(Lr.encode(Ur(e)));return te(t)}var Je=new Hr;Je.generateSecretKey;Je.getPublicKey;Je.finalizeEvent;var Rr=Je.verifyEvent,_r=22242;function Pr(e,t){if(e.ids&&e.ids.indexOf(t.id)===-1||e.kinds&&e.kinds.indexOf(t.kind)===-1||e.authors&&e.authors.indexOf(t.pubkey)===-1)return!1;for(let n in e)if(n[0]==="#"){let r=n.slice(1),o=e[`#${r}`];if(o&&!t.tags.find(([s,i])=>s===n.slice(1)&&o.indexOf(i)!==-1))return!1}return!(e.since&&t.created_at<e.since||e.until&&t.created_at>e.until)}function qr(e,t){for(let n=0;n<e.length;n++)if(Pr(e[n],t))return!0;return!1}function Mr(e,t){let n=t.length+3,r=e.indexOf(`"${t}":`)+n,o=e.slice(r).indexOf('"')+r+1;return e.slice(o,o+64)}function jr(e){let t=e.slice(0,22).indexOf('"EVENT"');if(t===-1)return null;let n=e.slice(t+7+1).indexOf('"');if(n===-1)return null;let r=t+7+1+n,o=e.slice(r+1,80).indexOf('"');if(o===-1)return null;let s=r+1+o;return e.slice(r+1,s)}function Vr(e,t){return{kind:_r,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e],["challenge",t]],content:""}}async function Kr(){return new Promise(e=>{const t=new MessageChannel,n=()=>{t.port1.removeEventListener("message",n),e()};t.port1.addEventListener("message",n),t.port2.postMessage(0),t.port1.start()})}var Wr=e=>(e[Ae]=!0,!0),pn=class{constructor(e,t){H(this,"url");H(this,"_connected",!1);H(this,"onclose",null);H(this,"onnotice",e=>console.debug(`NOTICE from ${this.url}: ${e}`));H(this,"_onauth",null);H(this,"baseEoseTimeout",4400);H(this,"connectionTimeout",4400);H(this,"openSubs",new Map);H(this,"connectionTimeoutHandle");H(this,"connectionPromise");H(this,"openCountRequests",new Map);H(this,"openEventPublishes",new Map);H(this,"ws");H(this,"incomingMessageQueue",new Or);H(this,"queueRunning",!1);H(this,"challenge");H(this,"serial",0);H(this,"verifyEvent");H(this,"_WebSocket");this.url=_e(e),this.verifyEvent=t.verifyEvent,this._WebSocket=t.websocketImplementation||WebSocket}static async connect(e,t){const n=new pn(e,t);return await n.connect(),n}closeAllSubscriptions(e){for(let[t,n]of this.openSubs)n.close(e);this.openSubs.clear();for(let[t,n]of this.openEventPublishes)n.reject(new Error(e));this.openEventPublishes.clear();for(let[t,n]of this.openCountRequests)n.reject(new Error(e));this.openCountRequests.clear()}get connected(){return this._connected}async connect(){return this.connectionPromise?this.connectionPromise:(this.challenge=void 0,this.connectionPromise=new Promise((e,t)=>{this.connectionTimeoutHandle=setTimeout(()=>{var n;t("connection timed out"),this.connectionPromise=void 0,(n=this.onclose)==null||n.call(this),this.closeAllSubscriptions("relay connection timed out")},this.connectionTimeout);try{this.ws=new this._WebSocket(this.url)}catch(n){t(n);return}this.ws.onopen=()=>{clearTimeout(this.connectionTimeoutHandle),this._connected=!0,e()},this.ws.onerror=n=>{var r;t(n.message||"websocket error"),this._connected&&(this._connected=!1,this.connectionPromise=void 0,(r=this.onclose)==null||r.call(this),this.closeAllSubscriptions("relay connection errored"))},this.ws.onclose=async()=>{var n;this._connected&&(this._connected=!1,this.connectionPromise=void 0,(n=this.onclose)==null||n.call(this),this.closeAllSubscriptions("relay connection closed"))},this.ws.onmessage=this._onmessage.bind(this)}),this.connectionPromise)}async runQueue(){for(this.queueRunning=!0;this.handleNext()!==!1;)await Kr();this.queueRunning=!1}handleNext(){var n,r,o;const e=this.incomingMessageQueue.dequeue();if(!e)return!1;const t=jr(e);if(t){const s=this.openSubs.get(t);if(!s)return;const i=Mr(e,"id"),c=(n=s.alreadyHaveEvent)==null?void 0:n.call(s,i);if((r=s.receivedEvent)==null||r.call(s,this,i),c)return}try{let s=JSON.parse(e);switch(s[0]){case"EVENT":{const i=this.openSubs.get(s[1]),c=s[2];this.verifyEvent(c)&&qr(i.filters,c)&&i.onevent(c);return}case"COUNT":{const i=s[1],c=s[2],a=this.openCountRequests.get(i);a&&(a.resolve(c.count),this.openCountRequests.delete(i));return}case"EOSE":{const i=this.openSubs.get(s[1]);if(!i)return;i.receivedEose();return}case"OK":{const i=s[1],c=s[2],a=s[3],u=this.openEventPublishes.get(i);c?u.resolve(a):u.reject(new Error(a)),this.openEventPublishes.delete(i);return}case"CLOSED":{const i=s[1],c=this.openSubs.get(i);if(!c)return;c.closed=!0,c.close(s[2]);return}case"NOTICE":this.onnotice(s[1]);return;case"AUTH":{this.challenge=s[1],(o=this._onauth)==null||o.call(this,s[1]);return}}}catch{return}}async send(e){if(!this.connectionPromise)throw new Error("sending on closed connection");this.connectionPromise.then(()=>{var t;(t=this.ws)==null||t.send(e)})}async auth(e){if(!this.challenge)throw new Error("can't perform auth, no challenge was received");const t=await e(Vr(this.url,this.challenge)),n=new Promise((r,o)=>{this.openEventPublishes.set(t.id,{resolve:r,reject:o})});return this.send('["AUTH",'+JSON.stringify(t)+"]"),n}async publish(e){const t=new Promise((n,r)=>{this.openEventPublishes.set(e.id,{resolve:n,reject:r})});return this.send('["EVENT",'+JSON.stringify(e)+"]"),t}async count(e,t){this.serial++;const n=(t==null?void 0:t.id)||"count:"+this.serial,r=new Promise((o,s)=>{this.openCountRequests.set(n,{resolve:o,reject:s})});return this.send('["COUNT","'+n+'",'+JSON.stringify(e).substring(1)),r}subscribe(e,t){const n=this.prepareSubscription(e,t);return n.fire(),n}prepareSubscription(e,t){this.serial++;const n=t.id||"sub:"+this.serial,r=new zr(this,n,e,t);return this.openSubs.set(n,r),r}close(){var e;this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,(e=this.ws)==null||e.close()}_onmessage(e){this.incomingMessageQueue.enqueue(e.data),this.queueRunning||this.runQueue()}},zr=class{constructor(e,t,n,r){H(this,"relay");H(this,"id");H(this,"closed",!1);H(this,"eosed",!1);H(this,"filters");H(this,"alreadyHaveEvent");H(this,"receivedEvent");H(this,"onevent");H(this,"oneose");H(this,"onclose");H(this,"eoseTimeout");H(this,"eoseTimeoutHandle");this.relay=e,this.filters=n,this.id=t,this.alreadyHaveEvent=r.alreadyHaveEvent,this.receivedEvent=r.receivedEvent,this.eoseTimeout=r.eoseTimeout||e.baseEoseTimeout,this.oneose=r.oneose,this.onclose=r.onclose,this.onevent=r.onevent||(o=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,o)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){var e;this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,(e=this.oneose)==null||e.call(this))}close(e="closed by caller"){var t;!this.closed&&this.relay.connected&&(this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]"),this.closed=!0),this.relay.openSubs.delete(this.id),(t=this.onclose)==null||t.call(this,e)}},Gr=class{constructor(e){H(this,"relays",new Map);H(this,"seenOn",new Map);H(this,"trackRelays",!1);H(this,"verifyEvent");H(this,"trustedRelayURLs",new Set);H(this,"_WebSocket");this.verifyEvent=e.verifyEvent,this._WebSocket=e.websocketImplementation}async ensureRelay(e,t){e=_e(e);let n=this.relays.get(e);return n||(n=new pn(e,{verifyEvent:this.trustedRelayURLs.has(e)?Wr:this.verifyEvent,websocketImplementation:this._WebSocket}),t!=null&&t.connectionTimeout&&(n.connectionTimeout=t.connectionTimeout),this.relays.set(e,n)),await n.connect(),n}close(e){e.map(_e).forEach(t=>{var n;(n=this.relays.get(t))==null||n.close()})}subscribeMany(e,t,n){return this.subscribeManyMap(Object.fromEntries(e.map(r=>[r,t])),n)}subscribeManyMap(e,t){this.trackRelays&&(t.receivedEvent=(l,f)=>{let g=this.seenOn.get(f);g||(g=new Set,this.seenOn.set(f,g)),g.add(l)});const n=new Set,r=[],o=Object.keys(e).length,s=[];let i=l=>{var f;s[l]=!0,s.filter(g=>g).length===o&&((f=t.oneose)==null||f.call(t),i=()=>{})};const c=[];let a=(l,f)=>{var g;i(l),c[l]=f,c.filter(S=>S).length===o&&((g=t.onclose)==null||g.call(t,c),a=()=>{})};const u=l=>{var g;if((g=t.alreadyHaveEvent)!=null&&g.call(t,l))return!0;const f=n.has(l);return n.add(l),f},h=Promise.all(Object.entries(e).map(async(l,f,g)=>{if(g.indexOf(l)!==f){a(f,"duplicate url");return}let[S,p]=l;S=_e(S);let w;try{w=await this.ensureRelay(S,{connectionTimeout:t.maxWait?Math.max(t.maxWait*.8,t.maxWait-1e3):void 0})}catch(B){a(f,(B==null?void 0:B.message)||String(B));return}let x=w.subscribe(p,{...t,oneose:()=>i(f),onclose:B=>a(f,B),alreadyHaveEvent:u,eoseTimeout:t.maxWait});r.push(x)}));return{async close(){await h,r.forEach(l=>{l.close()})}}}subscribeManyEose(e,t,n){const r=this.subscribeMany(e,t,{...n,oneose(){r.close()}});return r}async querySync(e,t,n){return new Promise(async r=>{const o=[];this.subscribeManyEose(e,[t],{...n,onevent(s){o.push(s)},onclose(s){r(o)}})})}async get(e,t,n){t.limit=1;const r=await this.querySync(e,t,n);return r.sort((o,s)=>s.created_at-o.created_at),r[0]||null}publish(e,t){return e.map(_e).map(async(n,r,o)=>o.indexOf(n)!==r?Promise.reject("duplicate url"):(await this.ensureRelay(n)).publish(t))}listConnectionStatus(){const e=new Map;return this.relays.forEach((t,n)=>e.set(n,t.connected)),e}destroy(){this.relays.forEach(e=>e.close()),this.relays=new Map}},yn;try{yn=WebSocket}catch{}var Dr=class extends Gr{constructor(){super({verifyEvent:Rr,websocketImplementation:yn})}};/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function $e(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function pe(...e){const t=(o,s)=>i=>o(s(i)),n=Array.from(e).reverse().reduce((o,s)=>o?t(o,s.encode):s.encode,void 0),r=e.reduce((o,s)=>o?t(o,s.decode):s.decode,void 0);return{encode:n,decode:r}}function ye(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(n=>{if($e(n),n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=e.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${e}`);return r})}}}function ge(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of t)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function Qe(e,t="="){if($e(e),typeof t!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let o of n)if(typeof o!="string")throw new Error(`padding.decode: non-string input=${o}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function gn(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function Rt(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const o=[],s=Array.from(e);for(s.forEach(i=>{if($e(i),i<0||i>=t)throw new Error(`Wrong integer: ${i}`)});;){let i=0,c=!0;for(let a=r;a<s.length;a++){const u=s[a],h=t*i+u;if(!Number.isSafeInteger(h)||t*i/t!==i||h-u!==t*i)throw new Error("convertRadix: carry overflow");if(i=h%n,s[a]=Math.floor(h/n),!Number.isSafeInteger(s[a])||s[a]*n+i!==h)throw new Error("convertRadix: carry overflow");if(c)s[a]?c=!1:r=a;else continue}if(o.push(i),c)break}for(let i=0;i<e.length-1&&e[i]===0;i++)o.push(0);return o.reverse()}const wn=(e,t)=>t?wn(t,e%t):e,ze=(e,t)=>e+(t-wn(e,t));function gt(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(ze(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${ze(t,n)}`);let o=0,s=0;const i=2**n-1,c=[];for(const a of e){if($e(a),a>=2**t)throw new Error(`convertRadix2: invalid data word=${a} from=${t}`);if(o=o<<t|a,s+t>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${t}`);for(s+=t;s>=n;s-=n)c.push((o>>s-n&i)>>>0);o&=2**s-1}if(o=o<<n-s&i,!r&&s>=t)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&s>0&&c.push(o>>>0),c}function Fr(e){return $e(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Rt(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Rt(t,e,2**8))}}}function Be(e,t=!1){if($e(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(ze(8,e)>32||ze(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return gt(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(gt(n,e,8,t))}}}function _t(e){if(typeof e!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch{}}}const Zr=pe(Be(4),ye("0123456789ABCDEF"),ge("")),Yr=pe(Be(5),ye("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Qe(5),ge(""));pe(Be(5),ye("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Qe(5),ge(""));pe(Be(5),ye("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),ge(""),gn(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const Jr=pe(Be(6),ye("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Qe(6),ge("")),Qr=pe(Be(6),ye("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Qe(6),ge("")),Tt=e=>pe(Fr(58),ye(e),ge("")),wt=Tt("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");Tt("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");Tt("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const Pt=[0,2,3,5,6,7,9,10,11],Xr={encode(e){let t="";for(let n=0;n<e.length;n+=8){const r=e.subarray(n,n+8);t+=wt.encode(r).padStart(Pt[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){const r=e.slice(n,n+11),o=Pt.indexOf(r.length),s=wt.decode(r);for(let i=0;i<s.length-o;i++)if(s[i]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(s.slice(s.length-o)))}return Uint8Array.from(t)}},bt=pe(ye("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),ge("")),qt=[996825010,642813549,513874426,1027748829,705979059];function Ue(e){const t=e>>25;let n=(e&33554431)<<5;for(let r=0;r<qt.length;r++)(t>>r&1)===1&&(n^=qt[r]);return n}function Mt(e,t,n=1){const r=e.length;let o=1;for(let s=0;s<r;s++){const i=e.charCodeAt(s);if(i<33||i>126)throw new Error(`Invalid prefix (${e})`);o=Ue(o)^i>>5}o=Ue(o);for(let s=0;s<r;s++)o=Ue(o)^e.charCodeAt(s)&31;for(let s of t)o=Ue(o)^s;for(let s=0;s<6;s++)o=Ue(o);return o^=n,bt.encode(gt([o%2**30],30,5,!1))}function bn(e){const t=e==="bech32"?1:734539939,n=Be(5),r=n.decode,o=n.encode,s=_t(r);function i(h,l,f=90){if(typeof h!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof h}`);if(!Array.isArray(l)||l.length&&typeof l[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof l}`);const g=h.length+7+l.length;if(f!==!1&&g>f)throw new TypeError(`Length ${g} exceeds limit ${f}`);return h=h.toLowerCase(),`${h}1${bt.encode(l)}${Mt(h,l,t)}`}function c(h,l=90){if(typeof h!="string")throw new Error(`bech32.decode input should be string, not ${typeof h}`);if(h.length<8||l!==!1&&h.length>l)throw new TypeError(`Wrong string length: ${h.length} (${h}). Expected (8..${l})`);const f=h.toLowerCase();if(h!==f&&h!==h.toUpperCase())throw new Error("String must be lowercase or uppercase");h=f;const g=h.lastIndexOf("1");if(g===0||g===-1)throw new Error('Letter "1" must be present between prefix and data only');const S=h.slice(0,g),p=h.slice(g+1);if(p.length<6)throw new Error("Data must be at least 6 characters long");const w=bt.decode(p).slice(0,-6),x=Mt(S,w,t);if(!p.endsWith(x))throw new Error(`Invalid checksum in ${h}: expected "${x}"`);return{prefix:S,words:w}}const a=_t(c);function u(h){const{prefix:l,words:f}=c(h,!1);return{prefix:l,words:f,bytes:r(f)}}return{encode:i,decode:c,decodeToBytes:u,decodeUnsafe:a,fromWords:r,fromWordsUnsafe:s,toWords:o}}const Ge=bn("bech32");bn("bech32m");const eo={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},to=pe(Be(4),ye("0123456789abcdef"),ge(""),gn(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),no={utf8:eo,hex:to,base16:Zr,base32:Yr,base64:Jr,base64url:Qr,base58:wt,base58xmr:Xr};`${Object.keys(no).join(", ")}`;var Re=new TextDecoder("utf-8");new TextEncoder;var mn=5e3;function ro(e){var o,s,i,c,a,u,h,l;let{prefix:t,words:n}=Ge.decode(e,mn),r=new Uint8Array(Ge.fromWords(n));switch(t){case"nprofile":{let f=Me(r);if(!((o=f[0])!=null&&o[0]))throw new Error("missing TLV 0 for nprofile");if(f[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:te(f[0][0]),relays:f[1]?f[1].map(g=>Re.decode(g)):[]}}}case"nevent":{let f=Me(r);if(!((s=f[0])!=null&&s[0]))throw new Error("missing TLV 0 for nevent");if(f[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(f[2]&&f[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(f[3]&&f[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:te(f[0][0]),relays:f[1]?f[1].map(g=>Re.decode(g)):[],author:(i=f[2])!=null&&i[0]?te(f[2][0]):void 0,kind:(c=f[3])!=null&&c[0]?parseInt(te(f[3][0]),16):void 0}}}case"naddr":{let f=Me(r);if(!((a=f[0])!=null&&a[0]))throw new Error("missing TLV 0 for naddr");if(!((u=f[2])!=null&&u[0]))throw new Error("missing TLV 2 for naddr");if(f[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!((h=f[3])!=null&&h[0]))throw new Error("missing TLV 3 for naddr");if(f[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:Re.decode(f[0][0]),pubkey:te(f[2][0]),kind:parseInt(te(f[3][0]),16),relays:f[1]?f[1].map(g=>Re.decode(g)):[]}}}case"nrelay":{let f=Me(r);if(!((l=f[0])!=null&&l[0]))throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:Re.decode(f[0][0])}}case"nsec":return{type:t,data:r};case"npub":case"note":return{type:t,data:te(r)};default:throw new Error(`unknown prefix ${t}`)}}function Me(e){let t={},n=e;for(;n.length>0;){let r=n[0],o=n[1],s=n.slice(2,2+o);if(n=n.slice(2+o),s.length<o)throw new Error(`not enough data to read on TLV ${r}`);t[r]=t[r]||[],t[r].push(s)}return t}function oe(e){return En("npub",an(e))}function Se(e){return En("note",an(e))}function oo(e,t){let n=Ge.toWords(t);return Ge.encode(e,n,mn)}function En(e,t){return oo(e,t)}var Ce=Symbol("verified"),so=e=>e instanceof Object;function io(e){if(!so(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]=="object")return!1}return!0}new TextDecoder("utf-8");var co=new TextEncoder,ao=class{generateSecretKey(){return fe.utils.randomPrivateKey()}getPublicKey(e){return te(fe.getPublicKey(e))}finalizeEvent(e,t){const n=e;return n.pubkey=te(fe.getPublicKey(t)),n.id=at(n),n.sig=te(fe.sign(at(n),t)),n[Ce]=!0,n}verifyEvent(e){if(typeof e[Ce]=="boolean")return e[Ce];const t=at(e);if(t!==e.id)return e[Ce]=!1,!1;try{const n=fe.verify(e.sig,t,e.pubkey);return e[Ce]=n,n}catch{return e[Ce]=!1,!1}}};function lo(e){if(!io(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function at(e){let t=hn(co.encode(lo(e)));return te(t)}var Xe=new ao,uo=Xe.generateSecretKey,fo=Xe.getPublicKey,ho=Xe.finalizeEvent;Xe.verifyEvent;(function(){const e=["wss://relay-jp.nostr.wirednet.jp","wss://yabu.me","wss://r.kojira.io","wss://nrelay-jp.c-stellar.net","wss://nostr.holybea.com"],t=["wss://nostr-relay.nokotaro.com","wss://relay.nostr.wirednet.jp","wss://relay.damus.io","wss://nos.lol"],n=["wss://relay-jp.nostr.wirednet.jp","wss://yabu.me","wss://r.kojira.io","wss://nrelay-jp.c-stellar.net","wss://nostr.holybea.com"],r=[9801,9821],o=9801,s=50,i="https://nostx.shino3.net/",c="http://localhost:9801",a=typeof window=="object",u=new Intl.DateTimeFormat("ja-jp",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),h=uo();fo(h);let l,f=[],g=[],S=[];if(a){let I=function(d){S=d[0],f=d[1],g=d[2];const y=document.getElementById("sstp-target"),b=document.getElementById("bottle-ifghost"),C=y.childElementCount;for(let v=0;v<C;v++)y.remove(0),b.remove(0);for(let v=0;v<f.length;v++){const m=document.createElement("option");m.setAttribute("value",f[v]),m.appendChild(document.createTextNode(f[v])),y.appendChild(m);const T=document.createElement("option");T.setAttribute("value",f[v]+","+g[v]),T.appendChild(document.createTextNode(f[v]+","+g[v])),b.appendChild(T)}const E=document.getElementById("bottle-send");E.disabled=f.length==0};U(),document.getElementById("refresh").addEventListener("click",function(){U()});const k=document.getElementById("bottle-send");k.addEventListener("click",async function(d){const y=document.getElementById("bottle-script");if(y==null)return;const b=y.value.replace(/\n/g,"");if(b=="")return;k.disabled=!0;const C=document.getElementById("bottle-ifghost").value,E={Script:b,IfGhost:C},m={kind:Number(document.getElementById("bottle-kind").value),pubkey:"",created_at:Math.floor(Date.now()/1e3),tags:[],content:JSON.stringify(E)};let T;document.getElementById("use-nip-07").checked&&window.nostr?T=await window.nostr.signEvent(m):T=ho(m,h),B.publish(n,T),y.value="",k.disabled=!1}),document.querySelectorAll('.tabs > input[type="radio"]').forEach(d=>{d.addEventListener("change",()=>{if(d.checked){const y=Number(document.getElementById("bottle-kind").value);d.id=="global"||d.id=="following"?(l.close(),l=$(e)):d.id=="bottle"&&(l.close(),l=R(n,y))}})}),document.getElementById("bottle-kind").addEventListener("change",()=>{const d=Number(document.getElementById("bottle-kind").value);l.close(),l=R(n,d)}),window.addEventListener("load",()=>{const d=document.getElementById("use-nip-07"),y=document.getElementById("npub-nip-07"),b=document.getElementById("login-with-nip-07");window.nostr&&window.nostr.getPublicKey?(b.addEventListener("change",async C=>{var v;const E=document.getElementById("pubkey");if(b.checked){const m=await((v=window.nostr)==null?void 0:v.getPublicKey());m!==void 0&&(E.value=oe(m),E.dispatchEvent(new Event("change")))}else E.value="",E.dispatchEvent(new Event("change"))}),d.addEventListener("change",async()=>{if(d.checked)await async function(){var E;const C=await((E=window.nostr)==null?void 0:E.getPublicKey());if(C!==void 0){y.value=oe(C);const v={kinds:[0],authors:[C],limit:1},m=[];Array.from(document.getElementById("enabled-relay").options).forEach(V=>{m.push(V.value)}),Array.from(document.getElementById("following-relay").options).forEach(V=>{m.push(V.value)}),Array.from(document.getElementById("bottle-relay").options).forEach(V=>{m.push(V.value)});const T=V=>{const K=JSON.parse(V.content),z=document.getElementById("bottle-profile-dt");if(z.innerHTML="",K.picture!=null){const F=document.createElement("img");F.src=K.picture,F.alt=K.name,F.width=s,F.height=s,z.appendChild(F)}z.appendChild(document.createTextNode(K.display_name));const ee=document.createElement("a");ee.setAttribute("href",i+oe(V.pubkey)),ee.textContent="@"+K.name,z.appendChild(ee);const Q=document.getElementById("bottle-profile-dd");Q.innerHTML="",Q.appendChild(document.createTextNode(K.about)),K.picture!=null&&document.querySelectorAll("#bottle-tl > dt").forEach(ae=>{if(ae.dataset.npub==oe(C)){const W=document.createElement("img");W.src=K.picture,W.alt=K.name,W.width=s,W.height=s,ae.appendChild(W)}})},_=()=>{j.close()},j=B.subscribeMany(m,[v],{onevent:T,oneose:_})}}();else{y.value="";const C=document.getElementById("bottle-profile-dt");C.innerHTML="";const E=document.getElementById("bottle-profile-dd");E.innerHTML="",document.querySelectorAll("#bottle-tl > dt > img").forEach(m=>{m.remove()})}})):(b.disabled=!0,d.disabled=!0,y.disabled=!0)});async function U(){const d=["EXECUTE SSTP/1.1","Charset: UTF-8","SecurityLevel: external","Command: GetFMO","",""],b=(await x(c+"/api/sstp/v1",d.join(`
`))).split(`\r
`),C=[],E=[],v=[];for(let m=0;m<b.length;m++)if(b[m].indexOf(".hwnd")>=0){const T=b[m].split("")[1].replace("\r","");C.push(T)}else if(b[m].indexOf(".name")>=0){const T=b[m].split("")[1].replace("\r","");E.push(T)}else if(b[m].indexOf(".keroname")>=0){const T=b[m].split("")[1].replace("\r","");v.push(T)}I([C,E,v])}}async function p(I,A,k,M,U,d,y){if(!document.getElementById("sstp-enable").checked)return;const b=document.getElementById("sstp-target").selectedIndex,C=S[b],E="\\0"+I.replace(/\\/g,"\\\\").replace(/\n/g,"\\n")+"\\e";A?await w([C,I.replace(/\n/g,"\\n"),A]):await w([C,E,A,1,I.replace(/\n/g,"\\n"),k,M,U,d,y])}async function w(I){const A=I[0],k=I[1],M=I[2],U=["NOTIFY SSTP/1.1","Charset: UTF-8","SecurityLevel: external","Sender: angolmois","Event: OnNostr","Option: nobreak",`ReceiverGhostHWnd: ${A}`];M&&U.push(`IfGhost: ${M}`),U.push(`Script: ${k}`),U.push(`Reference0: ${M?"Nostr-Bottle/0.1":"Nostr/0.4"}`);for(let y=3;y<I.length;y++)U.push(`Reference${y-2}: ${I[y]}`);U.push(""),U.push("");const d=await x(c+"/api/sstp/v1",U.join(`
`));return console.log(U.join(`
`),`
----------
`,d,`
----------
`),d}async function x(I="",A=""){return(await fetch(I,{method:"POST",headers:{"Content-Type":"text/plain"},body:A})).text()}const B=new Dr;if(B.trackRelays=!0,l=$(e),a){ne(e,t,n,r);const I=document.getElementById("pubkey");let A;I.addEventListener("change",()=>{const{type:k,data:M}=ro(I.value);let U="";if(typeof M=="string")U=M;else return;const d={kinds:[3],authors:[U],limit:1},y=[];Array.from(document.getElementById("enabled-relay").options).forEach(m=>{y.push(m.value)}),Array.from(document.getElementById("following-relay").options).forEach(m=>{y.push(m.value)});let b=!1;const C=async m=>{if(b)return;let T;const _=[];try{T=JSON.parse(m.content)}catch(O){console.log(O),console.log(m);return}b=!0;const j=[];m.tags.forEach(O=>{O[0]=="p"&&j.push(O[1])});const V=document.getElementById("following-relay");Array.from(V.options).forEach(O=>{V.remove(0)}),Object.keys(T).forEach(O=>{_.push(O);const D=document.createElement("option");D.textContent=O,V.add(D)});const K=_.map(O=>{try{B.ensureRelay(O)}catch(D){console.log("ensureRelay error: ",D)}});await Promise.all(K);const z={kinds:[0],authors:[U],limit:1},ee=O=>{const D=JSON.parse(O.content),le=document.getElementById("profile-dt");if(le.innerHTML="",D.picture!=null){const He=document.createElement("img");He.src=D.picture,He.alt=D.name,He.width=s,He.height=s,le.appendChild(He)}le.appendChild(document.createTextNode(D.display_name));const Oe=document.createElement("a");Oe.setAttribute("href",i+oe(O.pubkey)),Oe.textContent="@"+D.name,le.appendChild(Oe);const kt=document.getElementById("profile-dd");kt.innerHTML="",kt.appendChild(document.createTextNode(D.about))},Q=()=>{F.close()},F=B.subscribeMany(_,[z],{onevent:ee,oneose:Q});j.push(U);const ae={kinds:[1],authors:j,since:Math.floor(Date.now()/1e3)-30*60,limit:20},W=document.getElementById("following-tl");W.innerHTML="";const Z=O=>{P("following",_,O)},se=()=>{},we=B.subscribeMany(_,[ae],{onevent:Z,oneose:se});A&&A.close(),A=we},E=()=>{v.close()},v=B.subscribeMany(Array.from(new Set(y)),[d],{onevent:C,oneose:E})})}const L={},q={};function P(I,A,k){const M={kinds:[0],authors:[k.pubkey]};let U=!1;const d=C=>{if(!k.id||U)return;U=!0;const E=JSON.parse(C.content),v=document.createElement("dt");if(E.picture!=null){const O=document.createElement("img");O.src=E.picture,O.alt=E.name,O.width=s,O.height=s,v.appendChild(O)}v.appendChild(document.createTextNode(E.display_name));const m=document.createElement("a");m.setAttribute("href",i+oe(k.pubkey)),m.textContent="@"+E.name,v.appendChild(m);const T=document.createElement("time");T.textContent=u.format(new Date(k.created_at*1e3)),v.appendChild(T),v.setAttribute("id",I+"-"+Se(k.id)),v.setAttribute("data-timestamp",k.created_at.toString());const _=document.createElement("dd");let j=!1,V=!1,K="",z="";const ee=[];k.tags.forEach(O=>{O[0]=="e"?(j=!0,K=O[1],ee.push(Se(O[1]))):O[0]=="p"&&(V=!0,ee.push(oe(O[1])))}),j&&q[L[K]]!=null?(_.appendChild(document.createTextNode("@"+q[L[K]])),_.appendChild(document.createElement("br"))):V&&q[z]!=null&&(_.appendChild(document.createTextNode("@"+q[z])),_.appendChild(document.createElement("br"))),k.content.split(/(#\[\d+\])/).forEach(O=>{const D=O.match(/#\[(\d+)\]/);if(D){const le=document.createElement("a");le.setAttribute("href","#"+oe(ee[Number(D[1])])),le.textContent=O,_.appendChild(le)}else _.appendChild(document.createTextNode(O))});const Q=document.createElement("button");Q.textContent="Send SSTP",Q.addEventListener("click",function(O){p(k.content,"",E.name??"",E.display_name??"",E.picture??"",Se(k.id),oe(k.pubkey))}),v.appendChild(Q);const F=document.createElement("button");F.textContent="",F.addEventListener("click",function(O){const D=document.getElementById("login-with-nip-07");D.checked=!1;const le=document.getElementById("pubkey");le.value=oe(k.pubkey),le.dispatchEvent(new Event("change"));const Oe=document.getElementById("following");Oe.checked=!0}),v.appendChild(F);const ae=document.createElement("ul");ae.className="relay";for(const O of B.seenOn.get(k.id)??[]){const D=document.createElement("li");D.textContent=O.url,ae.appendChild(D)}_.appendChild(ae);const W=document.getElementById(I+"-tl");if(E.name in q||(q[k.pubkey]=E.name),k.id in L||(L[k.id]=k.pubkey),document.getElementById(I+"-"+Se(k.id)))return;const Z=W.querySelectorAll("dt");let se=!1,we=!1;if(Z.length>0){for(let O=0;O<Z.length;O++)if(Number(Z[O].dataset.timestamp)<k.created_at){W.insertBefore(_,Z[O]),W.insertBefore(v,_),se=!0,O==0&&(we=!0);break}se||(W.appendChild(v),W.appendChild(_),se=!0)}else we=!0,W.prepend(_),W.prepend(v);document.getElementById(I).checked&&we&&p(k.content,"",E.name??"",E.display_name??"",E.picture??"",Se(k.id),oe(k.pubkey))},y=()=>{b.close()},b=B.subscribeMany(A,[M],{onevent:d,oneose:y})}function N(I,A){if(!A.id)return;const k=JSON.parse(A.content),M=k.IfGhost,U=k.Script,d=document.createElement("dt");d.appendChild(document.createTextNode(M));const y=document.createElement("time");y.textContent=u.format(new Date(A.created_at*1e3)),d.appendChild(y),d.setAttribute("id",I+"-"+Se(A.id)),d.setAttribute("data-timestamp",A.created_at.toString()),d.setAttribute("data-npub",oe(A.pubkey)),oe(A.pubkey)==document.getElementById("npub-nip-07").value&&document.querySelectorAll("#bottle-profile-dt > img").forEach(V=>{d.appendChild(V.cloneNode(!1))});const b=document.createElement("dd"),C=document.createElement("button");C.textContent="Send SSTP",C.addEventListener("click",function(j){p(U,M)}),d.appendChild(C),b.appendChild(document.createTextNode(U));const E=document.createElement("ul");E.className="relay";for(const j of B.seenOn.get(A.id)??[]){const V=document.createElement("li");V.textContent=j.url,E.appendChild(V)}b.appendChild(E);const v=document.getElementById(I+"-tl");if(document.getElementById(I+"-"+Se(A.id)))return;const m=v.querySelectorAll("dt");let T=!1,_=!1;if(m.length>0){for(let j=0;j<m.length;j++)if(Number(m[j].dataset.timestamp)<A.created_at){v.insertBefore(b,m[j]),v.insertBefore(d,b),T=!0,j==0&&(_=!0);break}T||(v.appendChild(d),v.appendChild(b),T=!0)}else _=!0,v.prepend(b),v.prepend(d);document.getElementById(I).checked&&_&&p(U,M)}function $(I){const A={kinds:[1],since:Math.floor(Date.now()/1e3)-1800,limit:20};if(a){const d=document.getElementById("global-tl");d.innerHTML=""}const k=d=>{P("global",I,d)},M=()=>{};return B.subscribeMany(I,[A],{onevent:k,oneose:M})}function R(I,A){const k={kinds:[A],limit:20};if(a){const y=document.getElementById("bottle-tl");y.innerHTML=""}const M=y=>{N("bottle",y)},U=()=>{};return B.subscribeMany(I,[k],{onevent:M,oneose:U})}function ne(I,A,k,M){var E,v;const U=document.getElementById("enabled-relay");I.forEach(m=>{const T=document.createElement("option");T.setAttribute("value",m),T.appendChild(document.createTextNode(m)),U==null||U.appendChild(T)});const d=document.getElementById("disabled-relay");A.forEach(m=>{const T=document.createElement("option");T.setAttribute("value",m),T.appendChild(document.createTextNode(m)),d==null||d.appendChild(T)});const y=document.getElementById("bottle-relay");k.forEach(m=>{const T=document.createElement("option");T.setAttribute("value",m),T.appendChild(document.createTextNode(m)),y==null||y.appendChild(T)});const b=document.getElementById("bottle-kind");M.forEach(m=>{const T=document.createElement("option");T.setAttribute("value",m.toString()),T.appendChild(document.createTextNode(m.toString())),m==o&&(T.selected=!0),b==null||b.appendChild(T)}),(E=document.getElementById("remove"))==null||E.addEventListener("click",()=>C("enabled-relay","disabled-relay")),(v=document.getElementById("add"))==null||v.addEventListener("click",()=>C("disabled-relay","enabled-relay"));function C(m,T){const _=document.getElementById(m);if(!(_.selectedIndex>=0))return;const j=_.options[_.selectedIndex].value,V=document.getElementById(T),K=document.createElement("option");K.setAttribute("value",j),K.appendChild(document.createTextNode(j)),V.appendChild(K),_.remove(_.selectedIndex);const z=[];Array.from(document.getElementById("enabled-relay").options).forEach(ee=>{z.push(ee.value)}),l.close(),l=$(z)}}})();
